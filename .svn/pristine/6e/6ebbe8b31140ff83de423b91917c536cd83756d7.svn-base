<?xml version="1.0" encoding="UTF-8" ?><%@ page language="java" pageEncoding="UTF-8"%><%@ page import="java.net.URLEncoder" %><%@ page import="java.util.HashMap" %><%@ page import="org.springframework.web.bind.ServletRequestUtils" %><%@ page import="sun.misc.BASE64Encoder" %><%@ page import="com.osan.portal.vo.LoginInfo" %><%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %><%@ taglib uri="http://java.sun.com/jstl/core_rt" prefix="c" %><%@ taglib uri="http://java.sun.com/jstl/fmt_rt" prefix="fmt" %><%String menuLink = ServletRequestUtils.getStringParameter(request, "menuLink");String menuId = ServletRequestUtils.getStringParameter(request, "menuId");String userId = "";String userName = "";LoginInfo loginSessionInfo = (LoginInfo)request.getSession().getAttribute("sessionUserInfo");if(loginSessionInfo == null || loginSessionInfo.getUserNo() ==  null){    %>    <script type="text/javascript">    alert("세션이 종료되었습니다. 로그인 페이지로 이동합니다.");    window.close();    opener.location.href = "/";    </script>    <%}HashMap<String, String> hiddens = new HashMap<String, String>();hiddens.put("menuId",menuId);//교직원게시판if ("board".equals(menuId)){    if(loginSessionInfo != null) {        BASE64Encoder en = new BASE64Encoder();        hiddens.put("userNo", URLEncoder.encode(en.encode(loginSessionInfo.getUserNo().getBytes("UTF-8")),"UTF-8"));    }}else if("ojt".equals(menuId)){    if(loginSessionInfo != null) {        BASE64Encoder en = new BASE64Encoder();        hiddens.put("userNo", URLEncoder.encode(en.encode(loginSessionInfo.getUserNo().getBytes("UTF-8")),"UTF-8"));    }//NCS}else if("ncs".equals(menuId)){    if(loginSessionInfo != null) {        BASE64Encoder en = new BASE64Encoder();        hiddens.put("loginId", URLEncoder.encode(en.encode(loginSessionInfo.getUserNo().getBytes("UTF-8")),"UTF-8"));        String userAuth = loginSessionInfo.getUserAuth();        String isAdmin = "N";        if(userAuth.equals("1")||userAuth.equals("2")||userAuth.equals("3")||userAuth.equals("4")){            isAdmin = "Y";        }        hiddens.put("isAdmin", URLEncoder.encode(en.encode(isAdmin.getBytes("UTF-8")),"UTF-8"));        hiddens.put("jumpUrl", "Y");    }}else if("job".equals(menuId)){    if(loginSessionInfo != null) {        BASE64Encoder en = new BASE64Encoder();        hiddens.put("userNo", URLEncoder.encode(en.encode(loginSessionInfo.getUserNo().getBytes("UTF-8")),"UTF-8"));    }}else if("sh".equals(menuId)){    if(loginSessionInfo != null) {        BASE64Encoder en = new BASE64Encoder();        hiddens.put("userNo", URLEncoder.encode(en.encode(loginSessionInfo.getUserNo().getBytes("UTF-8")),"UTF-8"));    }}else if("lms".equals(menuId)){    if(loginSessionInfo != null) {    	userId = loginSessionInfo.getUserNo();    }	}else if("ostory".equals(menuId)){    if(loginSessionInfo != null) {    	userId = loginSessionInfo.getUserNo();    }   }else if("cb".equals(menuId)){    if(loginSessionInfo != null) {        userId = loginSessionInfo.getUserNo();    }    }else if("attend".equals(menuId)){    if(loginSessionInfo != null) {        userId = loginSessionInfo.getUserNo();    }  }else if("eduwill".equals(menuId)){    if(loginSessionInfo != null) {        userId = loginSessionInfo.getUserNo();        userName = loginSessionInfo.getName();    }  }request.setAttribute("menuLink", menuLink);request.setAttribute("menuId", menuId);request.setAttribute("hiddens", hiddens);%><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="icon" type="image/png"  href="../img/favicon.icon"/><title>메뉴전환</title><script type="text/javascript" src="../js/jquery-1.11.1.min.js"></script><script type="text/javascript" src="../js/aes.js"></script><script type="text/javascript" src="../js/sha256.js"></script><script type="text/javascript" charset="UTF-8">    $(document).ready(function(){        insertLog();        var userId = $("#userId").val();        var passKey = 'Syworks1004WjhStarR'        var encUserNo = CryptoJS.AES.encrypt(userId, passKey);        $("#userId").val(encUserNo);        enCode($("#UserName").val());        $('form').attr('target','_self').submit();    });    function insertLog(){        /*메뉴 접속 로그*/        var formData = $("#form1").serialize() + "&menuId=" + $("#menuId").val();        $.ajax({            type : "POST",            async : true,            url : "/insertMenuLog",            data : formData,            dataType : "text"        });    }    function enCode(param){    	var encode = '';    	for(i=0; i<param.length;i++){    		var len = '' + param.charCodeAt(i)    		var token = '' + len.length;    		encode += token + param.charCodeAt(i);    	}    	$("#UserName").val(encode);    }</script></head><body><form name="form1" action="${menuLink}" method="post"><input type="hidden" id="userId" name="userId" value="<%=userId%>"/><input type="hidden" id="UserID" name="UserID" value="<%=userId%>"/><input type="hidden" id="UserName_client" name="UserName_client" value="<%=userName%>"/><input type="hidden" id="UserName" name="UserName" value="<%=userName%>"/><input type="hidden" id="JisaCode" name="JisaCode" value="osan"/><input type="hidden" id="enc" name="enc" value="1"/><input type="hidden" id="rtnUrl" name="rtnUrl" /><c:forEach var="hidden" items="${hiddens}">    <input type="hidden" name="${hidden.key}" id="${hidden.key}" value="${hidden.value}" /></c:forEach><div style="text-align:center;">    <br/><br/></div></form></body></html>